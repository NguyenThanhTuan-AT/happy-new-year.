<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Happy New Year 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Playfair+Display:ital,wght@1,400;1,900&family=Quicksand:wght@300;500&display=swap" rel="stylesheet">
<style>
:root{--gold:#D4AF37;--neon-blue:#00f3ff;--deep-bg:#050505;}
*{box-sizing:border-box;margin:0;padding:0}
html,body{height:100%}
body{
  background:var(--deep-bg);
  color:#fff;
  font-family:'Quicksand',sans-serif;
  overflow:hidden;
  height:100vh;
  width:100vw;
  user-select:none;
}

/* C·∫§U TR√öC 2 L·ªöP CANVAS */
canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; display: block; }
#bgCanvas { z-index: 1; } /* N·ªÅn sao (V·∫Ω r√µ n√©t) */
#fwCanvas { z-index: 2; pointer-events: none; } /* Ph√°o hoa (Trong su·ªët) */

/* GIAO DI·ªÜN (UI) */
.main-ui{position:absolute;top:45%;left:50%;transform:translate(-50%,-50%);z-index:20;text-align:center;width:100%;pointer-events:none; mix-blend-mode: hard-light;}
.pre-title{font-family:'Cinzel',serif;letter-spacing:8px;font-size:1.1rem;color:var(--gold);text-transform:uppercase;margin-bottom:15px;opacity:0;animation:fadeIn 2s ease forwards 0.5s; text-shadow: 0 0 10px rgba(212, 175, 55, 0.5);}
.main-title{font-family:'Playfair Display',serif;font-size:6rem;font-weight:900;font-style:italic;line-height:1;background:linear-gradient(45deg,#fff,var(--gold),#fff,var(--neon-blue));background-size:300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:gradientFlow 4s ease infinite, scaleUp 1s ease forwards;opacity:0; text-shadow:0 10px 30px rgba(0,0,0,0.8);}

.countdown-container{display:flex;justify-content:center;gap:20px;margin-top:30px;}
.glass-card{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.1);backdrop-filter:blur(4px);padding:15px 25px;border-radius:15px;min-width:100px;box-shadow: 0 10px 30px rgba(0,0,0,0.5); opacity: 0; animation: slideUp 0.8s ease forwards 1s;}
.num{font-size:2.8rem;font-weight:700;display:block;text-shadow:0 0 15px var(--neon-blue); font-variant-numeric: tabular-nums;}
.txt{font-size:.7rem;text-transform:uppercase;letter-spacing:2px;opacity:.7;margin-top:5px;color:var(--gold)}

/* INPUT NH·∫¨P ƒêI·ªÄU ∆Ø·ªöC */
.wish-input-container{position:absolute;bottom:120px;left:50%;transform:translateX(-50%);z-index:100;display:flex;gap:10px;pointer-events:auto;}
.wish-input{background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);padding:12px 24px;border-radius:30px;color:#fff;width:320px;outline:none;font-family:inherit;font-size:1rem;backdrop-filter:blur(5px); transition: 0.3s;}
.wish-input:focus{border-color:var(--gold); background:rgba(255,255,255,0.1);}
.send-btn{background:linear-gradient(135deg, var(--gold), #b8860b);color:#000;border:none;padding:12px 30px;border-radius:30px;font-weight:700;cursor:pointer;transition:0.3s;box-shadow: 0 5px 15px rgba(212, 175, 55, 0.3);}
.send-btn:hover{transform:scale(1.05);box-shadow:0 0 25px var(--gold); filter: brightness(1.2);}

/* CREDIT & MUSIC */
.creator-credit{position:fixed;bottom:20px;right:30px;z-index:100;font-size:.9rem;color:rgba(255,255,255,.5);text-align:right}
.creator-credit span{color:var(--gold);font-weight:700;font-size:1.1rem;}

.music-control{position:fixed;bottom:20px;left:30px;z-index:100;cursor:pointer}
.play-btn{width:56px;height:56px;border-radius:50%;background:rgba(255,255,255,0.05);border:1px solid rgba(255,255,255,0.2);display:flex;align-items:center;justify-content:center;font-size:1.8rem;transition:0.3s;backdrop-filter:blur(4px);}
.play-btn:hover{border-color:var(--gold);transform:scale(1.1); box-shadow: 0 0 15px rgba(212, 175, 55, 0.5);}
.spin{animation:spin 4s linear infinite}

/* FLOATING WISH */
.floating-wish{position:absolute;font-family:'Cinzel',serif;font-size:1.6rem;font-weight:700;pointer-events:none;white-space:nowrap;animation:floatUp 3s ease-in forwards;z-index:200;text-shadow:0 0 10px currentColor, 0 0 20px currentColor;}

@keyframes fadeIn{to{opacity:1}}
@keyframes gradientFlow{0%{background-position:0 50%}50%{background-position:100% 50%}100%{background-position:0 50%}}
@keyframes scaleUp{to{opacity:1;transform:scale(1)}}
@keyframes slideUp{to{opacity:1;transform:translateY(0)}}
@keyframes floatUp{0%{opacity:0;transform:translateY(0) scale(0.8)}10%{opacity:1;transform:translateY(-20px) scale(1)}100%{opacity:0;transform:translateY(-60vh) scale(1.4); filter: blur(4px);}}
@keyframes spin{100%{transform:rotate(360deg)}}
@media(max-width:768px){.main-title{font-size:3.5rem}.glass-card{min-width:60px;padding:10px}.num{font-size:1.8rem}.wish-input{width:60vw}}
</style>
</head>
<body>

<audio id="bgMusic" loop>
    <source src="https://data.chiasenhac.com/downloads/2135/1/2134582-7f722004/128/Happy%20New%20Year%20-%20ABBA.mp3" type="audio/mpeg">
</audio>

<canvas id="bgCanvas"></canvas>
<canvas id="fireworksCanvas"></canvas>
<div id="wishesContainer"></div>

<div class="main-ui">
  <div class="pre-title">Counting down to the moment</div>
  <div class="main-title" id="yearTitle">2026</div>
  <div class="countdown-container" id="countdown">
    <div class="glass-card"><span class="num" id="d">00</span><span class="txt">Days</span></div>
    <div class="glass-card"><span class="num" id="h">00</span><span class="txt">Hours</span></div>
    <div class="glass-card"><span class="num" id="m">00</span><span class="txt">Minutes</span></div>
    <div class="glass-card"><span class="num" id="s">00</span><span class="txt">Seconds</span></div>
  </div>
</div>

<div class="wish-input-container">
  <input id="wishInput" class="wish-input" placeholder="Nh·∫≠p ƒëi·ªÅu ∆∞·ªõc nƒÉm m·ªõi..." maxlength="50" />
  <button class="send-btn" id="sendWishBtn">G·ª¨I</button>
</div>

<div class="creator-credit">Designed by <span>Tu√¢n :))</span></div>

<div class="music-control" id="toggleMusic" onclick="toggleMusic()">
  <div class="play-btn" id="playBtn">üíø</div>
</div>

<script>
// --- C·∫§U H√åNH ---
const IS_MOBILE = ('ontouchstart' in window) || /Mobi|Android|iPhone|iPad|iPod/i.test(navigator.userAgent);
const CONFIG = {
  starCount: IS_MOBILE ? 80 : 200,      // Gi·ªëng file g·ªëc
  connectDistance: IS_MOBILE ? 80 : 120,// Gi·ªëng file g·ªëc
  
  // ƒêi·ªÅu ch·ªânh m·∫≠t ƒë·ªô ph√°o hoa: Gi·∫£m xu·ªëng 0.05 (v·ª´a ph·∫£i)
  particleCount: IS_MOBILE ? 100 : 250, // S·ªë h·∫°t n·ªï v·∫´n gi·ªØ nhi·ªÅu ƒë·ªÉ r·ª±c r·ª°
  autoFireworkChance: 0.05,             // T·∫ßn su·∫•t b·∫Øn: ƒê√£ gi·∫£m xu·ªëng theo y√™u c·∫ßu
  gravity: 0.12,
  friction: 0.98
};

// --- SETUP CANVAS ---
const bgCvs = document.getElementById('bgCanvas');
const fwCvs = document.getElementById('fireworksCanvas');
const bgCtx = bgCvs.getContext('2d');
const fwCtx = fwCvs.getContext('2d');
const wishesContainer = document.getElementById('wishesContainer');
let width, height;

function resize(){
  width = window.innerWidth; height = window.innerHeight;
  // Thi·∫øt l·∫≠p ƒë·ªô ph√¢n gi·∫£i cao
  bgCvs.width = width; bgCvs.height = height;
  fwCvs.width = width; fwCvs.height = height;
  initStars();
}
window.addEventListener('resize', resize);

// --- 1. N·ªÄN SAO N·ªêI D√ÇY (M√É NGU·ªíN T·ª™ FILE G·ªêC) ---
let stars = [], mouse={x:null,y:null};
class Star{
  constructor(){this.reset()}
  reset(){
    this.x=Math.random()*width; this.y=Math.random()*height; 
    this.size=Math.random()*1.6+.2; 
    this.speedX=(Math.random()-0.5)*0.25; 
    this.speedY=(Math.random()-0.5)*0.25; 
    this.opacity=Math.random()*.8+.2;
  }
  update(){
    this.x+=this.speedX; this.y+=this.speedY;
    if(this.x<0||this.x>width)this.speedX*=-1;
    if(this.y<0||this.y>height)this.speedY*=-1;
    if(mouse.x!==null){
      const dx=this.x-mouse.x, dy=this.y-mouse.y, dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<90){this.x+=dx*0.03; this.y+=dy*0.03;}
    }
  }
  draw(){
    bgCtx.fillStyle=`rgba(255,255,255,${this.opacity})`;
    bgCtx.beginPath(); bgCtx.arc(this.x,this.y,this.size,0,Math.PI*2); bgCtx.fill();
  }
}
function initStars(){stars=[]; for(let i=0;i<CONFIG.starCount;i++) stars.push(new Star());}
function drawLines(){
  for(let i=0;i<stars.length;i++){
    for(let j=i+1;j<stars.length;j++){
      const dx=stars[i].x-stars[j].x, dy=stars[i].y-stars[j].y, dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<CONFIG.connectDistance){
          bgCtx.strokeStyle=`rgba(255,255,255,${1-dist/CONFIG.connectDistance})`; 
          bgCtx.lineWidth=0.5; 
          bgCtx.beginPath(); bgCtx.moveTo(stars[i].x,stars[i].y); bgCtx.lineTo(stars[j].x,stars[j].y); bgCtx.stroke();
      }
    }
  }
}
initStars();

// --- 2. PH√ÅO HOA V·∫¨T L√ù & R·ª∞C R·ª† ---
let rockets = [], particles = [];

class Rocket {
    constructor(tx, ty) {
        this.x = width/2 + (Math.random()-0.5)*200;
        this.y = height;
        this.tx = tx; this.ty = ty;
        const angle = Math.atan2(ty - height, tx - this.x);
        const speed = IS_MOBILE ? 15 : 17;
        this.vx = Math.cos(angle) * speed;
        this.vy = Math.sin(angle) * speed;
        this.hue = Math.random() * 360;
        this.trail = [];
        this.exploded = false;
    }
    update() {
        this.trail.push({x:this.x, y:this.y});
        if(this.trail.length > 5) this.trail.shift();

        this.x += this.vx; this.y += this.vy;
        this.vy += 0.25; // Tr·ªçng l·ª±c khi bay l√™n

        // N·ªï khi g·∫ßn ƒë√≠ch ho·∫∑c b·∫Øt ƒë·∫ßu r∆°i
        if (this.vy >= 0 || Math.hypot(this.x - this.tx, this.y - this.ty) < 20) {
            this.exploded = true; this.explode();
        }
    }
    explode() {
        for(let i=0; i<CONFIG.particleCount; i++) particles.push(new Particle(this.x, this.y, this.hue));
    }
    draw() {
        fwCtx.beginPath();
        if(this.trail.length>0) fwCtx.moveTo(this.trail[0].x, this.trail[0].y);
        else fwCtx.moveTo(this.x, this.y);
        for(let p of this.trail) fwCtx.lineTo(p.x, p.y);
        fwCtx.lineTo(this.x, this.y);
        fwCtx.strokeStyle = `hsl(${this.hue}, 100%, 60%)`;
        fwCtx.lineWidth = 2;
        fwCtx.stroke();
    }
}

class Particle {
    constructor(x, y, hue) {
        this.x=x; this.y=y; this.hue=hue;
        const a=Math.random()*Math.PI*2;
        const s=Math.random()*8+2; // T·ªëc ƒë·ªô n·ªï m·∫°nh
        this.vx=Math.cos(a)*s; this.vy=Math.sin(a)*s;
        this.friction=0.96; this.gravity=0.15;
        this.alpha=1; this.decay=Math.random()*0.015+0.005;
        this.brightness=Math.random()*40+60; // ƒê·ªô s√°ng cao
    }
    update() {
        this.vx*=this.friction; this.vy*=this.friction; this.vy+=this.gravity;
        this.x+=this.vx; this.y+=this.vy; this.alpha-=this.decay;
    }
    draw() {
        fwCtx.save();
        fwCtx.globalAlpha = this.alpha;
        // K·ª∏ THU·∫¨T L√ÄM S√ÅNG: LIGHTER
        fwCtx.globalCompositeOperation = 'lighter';
        fwCtx.fillStyle = `hsl(${this.hue}, 100%, ${this.brightness}%)`;
        fwCtx.beginPath(); fwCtx.arc(this.x,this.y,2.5,0,Math.PI*2); fwCtx.fill();
        fwCtx.restore();
    }
}

function launchFirework(x, y) {
    rockets.push(new Rocket(x, y));
}

// --- ANIMATION LOOP (S·ª¨A L·ªñI M·∫§T N·ªÄN) ---
function animate(){
    requestAnimationFrame(animate);

    // 1. V·∫Ω n·ªÅn sao: D√πng clearRect ƒë·ªÉ x√≥a s·∫°ch, gi·ªØ ƒë·ªô n√©t
    bgCtx.clearRect(0,0,width,height);
    stars.forEach(s=>{s.update();s.draw();});
    drawLines();

    // 2. V·∫Ω ph√°o hoa: D√πng destination-out ƒë·ªÉ l√†m m·ªù ƒëu√¥i M√Ä V·∫™N TRONG SU·ªêT
    fwCtx.globalCompositeOperation = 'destination-out';
    fwCtx.fillStyle = 'rgba(0, 0, 0, 0.15)'; // M·ª©c ƒë·ªô m·ªù ƒëu√¥i
    fwCtx.fillRect(0, 0, width, height);
    
    // Chuy·ªÉn l·∫°i ch·∫ø ƒë·ªô v·∫Ω b√¨nh th∆∞·ªùng ƒë√® l√™n tr√™n
    fwCtx.globalCompositeOperation = 'source-over';

    // T·ª± ƒë·ªông b·∫Øn
    if(Math.random() < CONFIG.autoFireworkChance) {
        launchFirework(Math.random()*width, Math.random()*height*0.5);
    }

    rockets.forEach((r,i)=>{ r.update(); r.draw(); if(r.exploded) rockets.splice(i,1); });
    particles.forEach((p,i)=>{ p.update(); p.draw(); if(p.alpha<=0) particles.splice(i,1); });
}

// --- INTERACTION & MUSIC ---
window.addEventListener('mousemove',e=>{mouse.x=e.clientX; mouse.y=e.clientY;});
// Click ƒë·ªÉ b·∫Øn + B·∫≠t nh·∫°c
window.addEventListener('mousedown',e=>{
    if(e.target.tagName!=='INPUT'&&e.target.tagName!=='BUTTON'){
        launchFirework(e.clientX, e.clientY);
        toggleMusic(true);
    }
});

function sendWish(){
    const txt=wishInput.value.trim(); if(!txt)return;
    const el=document.createElement('div'); el.className='floating-wish'; el.innerText=txt;
    const startX=Math.random()*(width-100)+50; el.style.left=startX+'px'; el.style.bottom='200px';
    const hue=Math.floor(Math.random()*360); el.style.color=`hsl(${hue},100%,75%)`; 
    wishesContainer.appendChild(el); wishInput.value='';
    
    toggleMusic(true);
    // B·∫Øn ch√πm ph√°o hoa ƒÉn m·ª´ng
    for(let i=0;i<8;i++) setTimeout(()=>launchFirework(startX+(Math.random()-.5)*200, height*0.3), i*100);
    setTimeout(()=>el.remove(),4000);
}
sendWishBtn.onclick=sendWish; wishInput.onkeypress=e=>{if(e.key==='Enter')sendWish()};

const audio=document.getElementById('bgMusic');
const playBtn=document.getElementById('playBtn');
function toggleMusic(forceStart=false){
    if(forceStart && !audio.paused) return;
    if(audio.paused){
        audio.play().catch(()=>{});
        playBtn.innerText='üíø'; playBtn.classList.add('spin');
    } else {
        audio.pause();
        playBtn.innerText='üíø'; playBtn.classList.remove('spin');
    }
}
document.getElementById('toggleMusic').onclick=()=>toggleMusic();

// Countdown
const nextYear = new Date().getFullYear() + 1;
document.getElementById('yearTitle').innerText = nextYear;
const targetDate = new Date(`Jan 1, ${nextYear} 00:00:00`).getTime();
setInterval(()=>{
    const diff = targetDate - Date.now();
    if(diff<0) return;
    document.getElementById('d').innerText=Math.floor(diff/86400000).toString().padStart(2,'0');
    document.getElementById('h').innerText=Math.floor((diff%86400000)/3600000).toString().padStart(2,'0');
    document.getElementById('m').innerText=Math.floor((diff%3600000)/60000).toString().padStart(2,'0');
    document.getElementById('s').innerText=Math.floor((diff%60000)/1000).toString().padStart(2,'0');
},1000);

resize(); animate();
</script>
</body>
</html>